# Анализ стоимости поездок Uber

Этот проект представляет собой комплексный анализ данных о поездках Uber с построением моделей машинного обучения для предсказания стоимости поездок.

## Описание

Проект включает в себя:
- Разведочный анализ данных (EDA)
- Очистку и предобработку данных
- Визуализацию распределений и закономерностей
- Создание новых признаков
- Построение и оценку моделей машинного обучения

## Требования

Для запуска проекта необходимы следующие библиотеки Python:

- pandas
- numpy
- matplotlib
- seaborn
- scikit-learn

Установите библиотеки с помощью команды:
```bash
pip install pandas numpy matplotlib seaborn scikit-learn
```

## Использование

1. Поместите файл с данными `uber.csv` в соответствующую директорию
2. Обновите путь к файлу в коде: `pd.read_csv("C:/Users/nurik/Desktop/uber.csv")`
3. Запустите скрипт для выполнения полного анализа

## Основные этапы анализа

### 1. Предобработка данных
- Удаление пропущенных значений
- Фильтрация аномальных значений (отрицательные стоимости, выбросы)
- Преобразование формата даты и времени

### 2. Анализ временных закономерностей
- Распределение стоимости поездок по часам дня
- Анализ по дням недели
- Сезонные изменения по месяцам
- Выявление пиковых часов с повышенной стоимостью

### 3. Анализ расстояний
- Расчет расстояния между точками посадки и высадки
- Фильтрация аномально длинных поездок
- Визуализация распределения расстояний

### 4. Модели машинного обучения
- Линейная регрессия
- Случайный лес (Random Forest)
- Оценка качества моделей с помощью метрик:
  - MAE (Средняя абсолютная ошибка)
  - MSE (Среднеквадратичная ошибка)
  - RMSE (Корень из среднеквадратичной ошибки)
  - R² (Коэффициент детерминации)

## Результаты

Проект включает различные визуализации:
- Гистограммы распределения стоимости и расстояний
- Линейные графики зависимости стоимости от времени
- Столбчатые диаграммы по дням недели
- Тепловые карты стоимости поездок
- Графики важности признаков
- Сравнение предсказаний моделей с реальными значениями

## Особенности

- Использование формулы гаверсинуса для расчета расстояний
- Автоматическое определение пиковых часов
- Сравнение нескольких моделей машинного обучения
- Визуальный анализ результатов предсказаний

Для получения дополнительной информации обратитесь к комментариям в коде.
